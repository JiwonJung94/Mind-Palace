트랜잭션은 데이터베이스에서 일련의 작업을 하나의 논리적 단위로 처리하는 것을 의미합니다. 트랜잭션은 다음과 같은 ACID 속성을 가집니다:

1. **원자성(Atomicity)**: 트랜잭션은 "모두 수행되거나 전혀 수행되지 않음"을 보장합니다. 이는 트랜잭션의 일부만 적용되는 일이 없음을 의미합니다.
    
2. **일관성(Consistency)**: 트랜잭션은 데이터베이스를 한 일관된 상태에서 다른 일관된 상태로 변환합니다. 이는 모든 정의된 무결성 제약 조건을 만족해야 함을 의미합니다.
    
3. **격리성(Isolation)**: 트랜잭션이 완료되기 전까지는 그 결과가 다른 트랜잭션에 보이지 않습니다.
    
4. **지속성(Durability)**: 트랜잭션이 커밋된 후에는 시스템 오류가 발생하더라도 그 결과가 데이터베이스에 영구적으로 반영됩니다.

## 트랜잭션의 역할

1. **복구(Recovery)**: 트랜잭션은 시스템 오류나 충돌 발생 시 데이터베이스를 일관된 상태로 복구하는 데 중요한 역할을 합니다. 트랜잭션이 실패하면, 데이터베이스는 자동으로 이전의 일관된 상태로 되돌릴 수 있습니다. 이는 데이터 손실을 방지하고 시스템의 신뢰성을 높입니다.
    
2. **동시성 관리(Concurrency Control)**: 트랜잭션은 여러 사용자가 동시에 데이터베이스에 접근할 때 발생할 수 있는 문제를 해결하는 데 필수적입니다. 트랜잭션을 통해 데이터의 일관성을 유지하고 경합 조건을 방지할 수 있습니다.

## 제약 조건 검사: 즉시 vs. 지연

전통적으로, 단일 테이블의 제약 조건 검사는 즉시 이루어지고, 여러 테이블에 걸친 제약 조건 검사는 트랜잭션 종료 시점(커밋 시점)에 이루어진다고 알려져 있습니다. 하지만 모든 제약 조건 검사는 즉시 이루어져야 한다는 주장이 있습니다. 그 이유는 다음과 같습니다:

1. **데이터베이스의 일관성 유지**: 데이터베이스는 우리가 참이라고 믿는 명제들의 집합으로 볼 수 있습니다. 만약 이 집합이 불일치를 포함하게 되면, 데이터베이스에서 얻는 모든 결과는 신뢰할 수 없게 됩니다. 비록 격리성 속성 덕분에 하나의 트랜잭션만이 특정 불일치를 볼 수 있을지라도, 그 트랜잭션은 여전히 불일치를 보게 되고 잘못된 결과를 초래할 수 있습니다.
    
2. **격리성의 한계**: 격리성은 트랜잭션 간의 상호작용을 완전히 차단하지 않습니다. 한 트랜잭션에서 발생한 불일치가 다른 트랜잭션으로 전파될 수 있어 데이터베이스의 일관성을 해칠 수 있습니다.
    
3. **프로그램의 일관된 실행**: 모든 프로그램이나 코드 단위가 데이터베이스가 항상 일관된 상태라고 가정할 수 있어야 합니다. 만약 제약 조건 검사가 지연된다면, 일관성을 가정하는 코드가 안전하게 실행될 수 없게 됩니다. 이는 코드의 재사용성을 저해하고 복잡성을 증가시킵니다.
    
4. **설계의 교환 가능성**: 기본 릴레이션 변수와 뷰의 교환 가능성 원칙에 따르면, 동일한 제약 조건이 데이터베이스 설계에 따라 단일 릴레이션 변수 제약 조건이 되기도 하고, 다중 릴레이션 변수 제약 조건이 되기도 합니다. 따라서, 단일 릴레이션 변수 제약 조건이 즉시 검사되어야 한다면, 다중 릴레이션 변수 제약 조건도 즉시 검사되어야 합니다.
    
5. **시맨틱 최적화**: 시맨틱 최적화는 제약 조건을 사용하여 쿼리를 간소화하고 성능을 향상시키는 기법입니다. 예를 들어, 특정 무결성 제약 조건 덕분에 복잡한 쿼리를 단순화할 수 있습니다. 그러나 제약 조건이 항상 만족되지 않는다면, 이러한 최적화는 유효하지 않게 되고 쿼리 결과가 잘못될 수 있습니다.

## 다중 할당 (Multiple Assignment)

다중 할당은 데이터베이스의 일관성을 효율적으로 유지하기 위한 또 다른 방법입니다. 여러 데이터 변경 작업을 동시에 수행하여, 중간 상태에서 일관성이 깨지는 것을 방지합니다. 다중 할당은 원자적 연산으로 처리되어, 모든 작업이 성공하거나 모두 실패하는 방식으로 데이터베이스의 일관성을 보장합니다. 다중 할당의 주요 특징은 다음과 같습니다:

- **동시성:** 여러 개의 할당 작업이 마치 동시에 수행되는 것처럼 처리됩니다. 이는 중간 상태에서 일관성이 깨지는 것을 방지합니다.
- **원자성:** 다중 할당은 하나의 원자적 연산으로 간주됩니다. 따라서 모든 할당 작업이 성공하거나, 모두 실패해야 합니다.

예를 들어, 고객 A와 주문 B의 상태를 동시에 '완료'로 업데이트하는 상황을 생각해봅시다. 다중 할당을 사용하면, 두 업데이트가 하나의 원자적 연산으로 처리되어 중간에 데이터 일관성이 깨질 가능성을 방지할 수 있습니다. 이를 통해 고객과 주문의 상태가 항상 동기화된 상태로 유지될 수 있습니다.

### SQL에서의 다중 할당

SQL에서는 다중 할당을 일부 지원하지만 모든 경우에 적용되지는 않습니다. 예를 들어, 참조 동작(CASCADE)이나 특정 조인 뷰 업데이트는 다중 할당의 형태로 처리될 수 있습니다. 이러한 기능들은 데이터베이스가 여러 테이블에 걸쳐 일관성을 유지하는 데 도움을 줍니다. 그러나 여러 테이블에 대한 명시적인 동시 할당은 SQL에서 제한적으로 지원됩니다.


## 황금률: 업데이트와 제약 조건

데이터베이스의 무결성을 보장하기 위해, 다음과 같은 황금률이 적용됩니다:

1. **릴레이션 변수 제약 조건**: 어떤 업데이트 작업도 릴레이션 변수의 제약 조건을 FALSE로 평가하도록 해서는 안 됩니다.
2. **데이터베이스 제약 조건**: 어떤 업데이트 작업도 데이터베이스의 제약 조건을 FALSE로 평가하도록 해서는 안 됩니다.

이 황금률은 모든 무결성 검사가 즉시 이루어져야 한다는 원칙에 따라 업데이트 작업을 기준으로 설명됩니다. 이는 트랜잭션이 아닌 개별 업데이트 작업 수준에서 데이터의 일관성을 유지해야 한다는 것을 의미합니다.