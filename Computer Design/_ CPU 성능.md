컴파일러가 명령어를 생성하여 실행하고, 컴퓨터가 이 명령어들을 실행해야 프로그램이 동작하기 때문에, 실행 시간은 프로그램 내 명령어 수에 의존할 수밖에 없습니다. 실행 시간을 생각하는 한 가지 방법은 실행 시간이 "실행된 명령어 수 × 명령어당 평균 실행 시간"과 같다는 것입니다. 따라서 프로그램에 필요한 클록 주기 수는 다음과 같이 표현할 수 있습니다:

$$
\text{CPU 클록 주기 수} = \text{프로그램의 명령어 수} × \text{명령어당 평균 클록 주기 수}
$$

명령어당 평균 클록 주기 수를 나타내는 용어는 **CPI**(Clock Cycles Per Instruction)로 줄여서 표현되며, 이는 각 명령어를 실행하는 데 소요되는 클록 주기의 평균값입니다. 명령어가 수행하는 작업에 따라 실행 시간이 서로 다를 수 있으므로, CPI는 프로그램에서 실행된 모든 명령어의 평균값입니다.

CPI는 동일한 명령어 집합 구조(Instruction Set Architecture)를 사용하는 두 가지 다른 구현 방식을 비교하는 한 가지 방법을 제공합니다. 동일한 프로그램에 대해 실행된 명령어 수는 당연히 동일하기 때문입니다.

이제 기본적인 성능 방정식을 명령어 수(프로그램이 실행한 명령어의 수), CPI(명령어당 평균 클록 주기 수), 그리고 클록 주기 시간으로 표현할 수 있습니다:

$$
\text{CPU 시간} = \text{명령어 수} × \text{CPI} × \text{클록 주기 시간}
$$
또는, 클록 속도가 클록 주기 시간의 역수임을 고려하면:

$$
\text{CPU 시간} = \text{명령어 수} × \text{CPI} / \text{클록 속도}
$$

**컴퓨터 성능의 완전하고 신뢰할 수 있는 유일한 척도는 "시간"이라는 점을 항상 염두에 두어야 합니다.** 예를 들어, 명령어 집합을 변경하여 명령어 수를 줄이는 경우, 클록 주기 시간이 느려지거나 CPI가 높아져 명령어 수 감소로 인한 개선 효과가 상쇄될 수 있습니다. 마찬가지로, CPI는 실행되는 명령어의 유형에 따라 달라지기 때문에, 가장 적은 수의 명령어를 실행하는 코드가 반드시 가장 빠른 코드라고는 할 수 없습니다.

### **함정: 컴퓨터의 한 측면을 개선하면, 그 개선 비율만큼 전체 성능이 향상될 것이라고 기대하는 것**

"일반적인 경우를 빠르게 만드는 것"이라는 훌륭한 아이디어는 하드웨어와 소프트웨어 설계자들을 괴롭혀 온 낙담스러운 결과를 가져옵니다. 이는 개선의 기회가 해당 이벤트가 소비하는 시간에 따라 달라진다는 사실을 상기시켜줍니다. 이를 잘 보여주는 간단한 설계 문제가 있습니다.

어떤 프로그램이 한 컴퓨터에서 100초 동안 실행되고, 이 중 곱셈 연산이 80초를 차지한다고 가정해봅시다. 프로그램 실행 시간을 5배 빠르게 만들고 싶다면, 곱셈 연산 속도를 얼마나 개선해야 할까요?

개선 후 프로그램의 실행 시간은 아래의 간단한 식으로 표현됩니다. 이 식은 **암달의 법칙**(Amdahl's Law)으로 알려져 있습니다.

$$
\text{Execution time after improvement} = \frac{\text{Execution time affected by improvement}}{\text{Amount of improvement}} + \text{Execution time unaffected}

$$


이 문제에서는:  
$$
\text{Execution time after improvement}=80/n+20
$$
프로그램 성능을 5배 빠르게 만들고 싶다면, 새로운 실행 시간은 20초가 되어야 합니다. 따라서:  
$$
20=80/n+20
$$
이를 계산하면:  
$$
n=∞
$$
즉, 곱셈 연산이 워크로드의 80%만 차지한다면, 성능을 5배로 증가시키기 위해 곱셈을 개선할 수 있는 방법은 없습니다. 특정 개선으로 가능한 성능 향상은 개선된 기능이 사용되는 정도에 의해 제한됩니다. 일상생활에서도 이 개념은 **수확 체감의 법칙**(law of diminishing returns)이라고 불립니다.

암달의 법칙은 특정 기능이 소비하는 시간과 잠재적인 속도 향상을 알 때 성능 향상을 추정하는 데 사용할 수 있습니다. 암달의 법칙은 CPU 성능 방정식과 함께 잠재적 개선 사항을 평가하는 데 유용한 도구입니다. 또한, 암달의 법칙은 병렬 프로세서 수의 실질적인 한계를 논증하는 데 사용됩니다.