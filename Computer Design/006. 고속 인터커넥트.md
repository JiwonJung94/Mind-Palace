### 고속 인터커넥트의 필요성

컴퓨터 시스템에서 데이터 전송은 중앙처리장치(CPU), 메모리, 저장장치, 그래픽 카드, 네트워크 장치 등 여러 구성 요소 간의 상호작용을 통해 이루어집니다. 초기 컴퓨터 시스템에서는 병렬 방식의 버스(bus)를 사용하여 데이터를 전송했지만, 이러한 구조는 여러 한계에 직면하게 되었습니다.

기존의 병렬 버스는 여러 데이터 라인에서 동시에 신호를 전송함으로써 높은 대역폭을 제공하려고 했습니다. 그러나 데이터 라인이 많아질수록 신호 간 간섭(crosstalk)이 발생하고, 신호 동기화가 어려워지며, 전송 속도가 제한되는 문제가 나타났습니다. 특히, 병렬 버스는 데이터 전송 거리가 길어질수록 신호 왜곡과 지연이 증가하여 성능이 저하되었습니다. 이러한 병목현상은 고성능 컴퓨팅에서 심각한 문제로 작용했습니다.

고속 데이터 전송은 이러한 병목현상을 해결하고, 대규모 데이터 처리 및 고해상도 멀티미디어 콘텐츠를 지원하기 위해 필수적입니다. 이를 위해 현대 컴퓨터는 병렬 방식 대신 직렬 방식의 고속 인터커넥트를 채택하고 있으며, PCIe, NVMe와 같은 다양한 기술이 개발되었습니다.

### PCIe (Peripheral Component Interconnect Express)

PCIe는 컴퓨터 내부의 고속 데이터 전송을 위해 설계된 인터커넥트 기술로, 주로 그래픽 카드, SSD, 네트워크 카드 등 고성능 하드웨어를 연결하는 데 사용됩니다. PCIe는 기존의 병렬 PCI(Peripheral Component Interconnect) 방식을 대체하며, 직렬 연결 방식을 채택하여 데이터 전송 속도와 확장성을 크게 향상시켰습니다.

PCI와 PCIe는 컴퓨터 내부에서 데이터를 전송하기 위한 인터페이스 기술로, 두 기술은 데이터 전송 방식과 구조에서 근본적인 차이를 가지고 있습니다. 기존 PCI(Peripheral Component Interconnect)는 병렬 버스 기반 아키텍처를 사용하며, 여러 장치가 하나의 공유된 데이터 경로를 통해 통신합니다. 이 방식에서는 모든 장치가 동일한 버스를 공유하기 때문에, 데이터 전송 시 충돌이 발생하거나 병목현상이 나타날 수 있습니다. 또한, 병렬 전송 방식은 신호 간섭과 노이즈 문제를 야기할 가능성이 있으며, 전송 속도를 높이는 데 한계가 있었습니다.

반면, PCIe(Peripheral Component Interconnect Express)는 직렬 연결 방식을 채택하여 이러한 문제를 해결합니다. PCIe는 포인트 투 포인트(point-to-point) 연결 방식을 기반으로 하며, 각 장치가 독립적인 데이터 경로를 통해 통신하도록 설계되었습니다. 이로 인해 장치 간 데이터 충돌이 발생하지 않으며, 병렬 방식에서 나타나는 병목현상이 제거됩니다. PCIe는 데이터를 전송하기 위해 레인(lane)이라는 개념을 사용합니다. 레인은 하나의 송신 채널과 하나의 수신 채널로 구성되며, 양방향 데이터 전송을 지원합니다. PCIe는 1레인(x1)부터 16레인(x16)까지 확장 가능하며, 레인의 수가 많을수록 데이터 전송 속도가 증가합니다.

PCIe의 작동 원리는 패킷 기반 통신 방식을 따릅니다. 데이터는 소규모 패킷으로 나뉘어 전송되며, 이를 통해 데이터 흐름이 효율적으로 관리됩니다. 패킷 기반 통신은 데이터 전송 중 오류를 쉽게 검출하고 수정할 수 있는 장점을 제공합니다. PCIe는 계층 구조로 설계되어 있으며, 물리 계층, 데이터 링크 계층, 트랜잭션 계층으로 구성됩니다. 물리 계층은 신호 전송 방식을 담당하며, 데이터가 실제로 전송되는 물리적 경로를 정의합니다. 데이터 링크 계층은 데이터 무결성을 보장하기 위해 오류 검출 및 수정 메커니즘을 제공합니다. 트랜잭션 계층은 데이터 패킷의 흐름을 관리하며, 패킷의 생성, 전송, 수신 과정을 제어합니다. 이러한 계층 구조는 데이터 전송의 안정성과 효율성을 높이는 데 기여합니다.

PCIe는 병렬 방식의 PCI와 비교했을 때 여러 가지 장점을 제공합니다. 직렬 방식은 신호 간섭과 노이즈 문제를 줄이고, 더 높은 데이터 전송 속도를 가능하게 합니다. 또한, 포인트 투 포인트 연결 방식은 각 장치가 독립적인 데이터 경로를 가지므로 확장성과 호환성이 뛰어납니다. PCIe는 다양한 하드웨어 장치와 호환되며, 최신 버전에서는 더 높은 데이터 전송 속도를 지원하여 고성능 그래픽 카드, NVMe SSD, 고속 네트워크 어댑터와 같은 장치에서 널리 사용됩니다.

PCIe의 계층 구조는 물리 계층, 데이터 링크 계층, 트랜잭션 계층으로 구성되어 있으며, 각 계층은 데이터 전송의 특정 기능을 담당합니다. 계층 구조는 데이터가 송신 측에서 수신 측으로 이동하는 과정에서 각 단계의 역할을 명확히 분리하여 데이터 전송의 안정성과 효율성을 높이는 데 기여합니다.

물리 계층은 PCIe 데이터 전송의 가장 하위 계층으로, 데이터가 실제로 전송되는 전기적 신호와 물리적 인터페이스를 정의합니다. 이 계층은 데이터를 직렬 신호로 변환하여 송신하며, 수신 측에서는 이 직렬 신호를 다시 병렬 데이터로 변환합니다. 직렬 방식은 병렬 방식에 비해 신호 간섭과 노이즈 문제를 줄이고, 더 높은 데이터 전송 속도를 제공할 수 있습니다. 물리 계층은 레인(lane)이라는 단위를 통해 데이터를 전송합니다. 레인은 하나의 송신 채널과 하나의 수신 채널로 구성되며, 양방향 데이터 전송을 지원합니다. 예를 들어, x1 레인은 하나의 송신 채널과 수신 채널을 가지며, x16 레인은 16개의 송신 및 수신 채널을 제공합니다. 물리 계층은 데이터 전송을 위한 클럭 신호와 동기화 메커니즘을 포함하며, 데이터 전송 중 신호 무결성을 유지하기 위해 설계되었습니다.

데이터 링크 계층은 물리 계층 위에 위치하며, 데이터 전송 중 발생할 수 있는 오류를 감지하고 수정하는 역할을 합니다. 이 계층은 데이터의 무결성을 보장하기 위해 CRC(Cyclic Redundancy Check)와 같은 오류 검출 메커니즘을 사용합니다. 데이터가 송신 측에서 전송될 때, 이 계층은 데이터 패킷에 오류 검출 코드를 추가합니다. 수신 측에서는 이 코드를 확인하여 데이터가 손상되었는지 여부를 판단합니다. 데이터가 손상되었을 경우, ACK/NACK 메커니즘을 통해 송신 측에 재전송을 요청합니다. ACK(Acknowledgment)는 데이터가 성공적으로 수신되었음을 나타내며, NACK(Negative Acknowledgment)는 데이터가 손상되었거나 누락되었음을 나타냅니다. 데이터 링크 계층은 데이터 전송의 신뢰성을 높이는 데 핵심적인 역할을 하며, 물리 계층에서 발생할 수 있는 신호 오류를 보완합니다.

트랜잭션 계층은 데이터 링크 계층 위에 위치하며, 데이터 패킷을 생성하고 관리하는 역할을 합니다. 이 계층은 데이터를 TLP(Transaction Layer Packet)라는 구조로 캡슐화하여 전송합니다. TLP는 헤더, 데이터 페이로드, 오류 검출 코드로 구성되며, 데이터 전송의 효율성을 높이는 데 사용됩니다. 트랜잭션 계층은 크레딧 기반 흐름 제어를 통해 데이터 흐름을 관리합니다. 크레딧 기반 흐름 제어는 송신 측과 수신 측 간의 데이터 전송 속도를 동적으로 조절하는 방식으로 작동합니다. 수신 측은 자신의 데이터 처리 용량을 크레딧 형태로 송신 측에 알립니다. 송신 측은 이러한 크레딧 정보를 기반으로 데이터를 전송하며, 수신 측의 처리 용량을 초과하지 않도록 데이터를 조절합니다. 이 방식은 데이터 전송 과정에서 발생할 수 있는 과부하를 방지하며, 데이터가 원활하게 흐를 수 있도록 보장합니다. 예를 들어, 수신 측이 처리할 수 있는 데이터 용량이 제한적인 경우, 송신 측은 데이터를 천천히 전송하여 수신 측이 처리할 시간을 확보합니다. 반대로, 수신 측이 충분한 처리 용량을 가지고 있다면 송신 측은 데이터를 빠르게 전송할 수 있습니다. 이러한 방식은 데이터 전송의 효율성을 높이고 병목현상을 최소화합니다.

트랜잭션 계층은 또한 메모리 읽기 및 쓰기 요청, I/O 요청, 인터럽트 요청과 같은 고수준 작업을 처리하는 데 필요한 기능을 제공합니다. 이 계층은 데이터 전송의 논리적 흐름을 제어하며, QoS(서비스 품질) 관리는 PCIe에서 데이터 전송의 우선순위를 설정하는 데 사용됩니다. QoS는 서로 다른 데이터 유형이나 작업에 대해 우선순위를 부여하여 중요한 데이터가 먼저 처리될 수 있도록 합니다. PCIe는 다양한 응용 프로그램과 장치에서 동시에 작동할 수 있기 때문에, 데이터 전송 중 우선순위 관리가 필요합니다. 예를 들어, 실시간 비디오 스트리밍이나 고속 데이터 처리 작업은 일반적인 데이터 전송보다 높은 우선순위를 요구할 수 있습니다. PCIe는 이러한 우선순위를 설정하고 관리하여 중요한 데이터가 지연 없이 처리될 수 있도록 보장합니다. 트랜잭션 계층은 데이터 전송의 효율성과 안정성을 높이는 데 중요한 역할을 하며, PCIe가 다양한 응용 분야에서 고속 데이터 전송을 지원할 수 있도록 합니다.

### PCIe의 발전 과정과 기술적 특징

PCIe는 초기 버전에서부터 현재의 최신 버전까지 성능 향상을 목표로 꾸준히 발전해 왔습니다. 각 버전은 이전 버전에 비해 데이터 전송 속도(Gigatransfers per second, GT/s)가 크게 증가했으며, 이를 통해 더 높은 대역폭을 제공합니다.

PCIe 3.0은 초당 8 GT/s의 데이터 전송 속도를 지원하며, 이전 세대에 비해 효율적인 데이터 전송을 가능하게 했습니다. 이후 PCIe 4.0에서는 속도가 두 배로 증가하여 16 GT/s를 지원하게 되었고, 이는 고성능 컴퓨팅 환경에서 요구되는 데이터 처리량을 충족하는 데 기여했습니다. PCIe 5.0은 32 GT/s의 속도로 다시 한 번 대역폭을 두 배로 늘렸으며, 데이터센터와 같은 대규모 데이터 처리 환경에서 더욱 중요한 역할을 하게 되었습니다.

가장 최신 버전인 PCIe 6.0은 64 GT/s의 데이터 전송 속도를 지원하며, 이전 버전과 달리 PAM-4(4레벨 펄스 진폭 변조) 기술을 도입했습니다. PAM-4는 기존의 NRZ(Non-Return to Zero) 신호 방식과 비교하여 동일한 주파수 대역에서 더 많은 데이터를 전송할 수 있는 기술입니다. 이를 통해 대역폭이 크게 증가했으며, 고속 데이터 전송이 필요한 응용 분야에서 매우 유용하게 사용됩니다. 또한 PCIe 6.0은 데이터 무결성을 유지하기 위해 포워드 에러 수정(FEC, Forward Error Correction) 기술을 활용하여 신호 품질을 보장합니다.

최신 PCIe 버전은 성능 향상뿐만 아니라 전력 효율성 개선에도 중점을 두고 있습니다. 이는 고성능 컴퓨팅 환경에서 전력 소비를 줄이고, 시스템의 열 관리 문제를 완화하는 데 기여합니다. PCIe 6.0은 PAM-4 기술을 도입하면서도 전력 소비를 최소화하기 위해 최적화된 설계를 적용했으며, 이는 데이터센터와 같은 대규모 환경에서 중요한 이점으로 작용합니다.

또한 PCIe는 전력 관리 기능을 강화하여 유휴 상태에서의 전력 소비를 줄이고, 필요에 따라 동적으로 전력 소비를 조절하는 메커니즘을 제공합니다. 이러한 기능은 대규모 시스템에서 에너지 효율성을 높이는 데 기여하며, 지속 가능한 컴퓨팅 환경을 조성하는 데 도움을 줍니다.

### PCIe 스위치

PCIe 스위치는 여러 장치가 단일 PCIe 슬롯을 공유할 수 있도록 설계된 하드웨어 장치입니다. 일반적으로 마더보드에는 제한된 수의 PCIe 슬롯이 존재하며, 이러한 제한은 데이터센터나 서버 환경에서 여러 장치를 연결해야 하는 상황에서 문제가 될 수 있습니다. PCIe 스위치는 이러한 문제를 해결하기 위해 사용됩니다. 스위치는 하나의 PCIe 슬롯을 여러 개의 가상 슬롯으로 분리하여 여러 장치가 동일한 물리적 리소스를 공유할 수 있도록 합니다. 예를 들어, 하나의 PCIe x16 슬롯에 PCIe 스위치를 연결하면, 이 스위치를 통해 여러 장치가 각각 x4 또는 x8 레인을 사용할 수 있습니다. 스위치는 이러한 연결을 관리하고, 각 장치가 효율적으로 작동할 수 있도록 데이터 흐름을 조정합니다.

PCIe 스위치는 데이터센터와 서버 환경에서 특히 유용합니다. 데이터센터는 대규모의 컴퓨팅 리소스를 효율적으로 관리해야 하며, 이를 위해 제한된 PCIe 슬롯을 최대한 활용해야 합니다. PCIe 스위치를 사용하면 여러 GPU, NVMe 스토리지 장치, 네트워크 어댑터 등을 단일 슬롯에 연결할 수 있어 공간과 비용을 절약할 수 있습니다. 또한, 스위치는 장치 간의 데이터 충돌을 방지하고, 각 장치가 필요한 대역폭을 안정적으로 확보할 수 있도록 지원합니다. 일부 고급 PCIe 스위치는 동적 리소스 할당 기능을 제공하여, 특정 장치가 더 높은 대역폭을 필요로 할 때 이를 자동으로 조정할 수 있습니다.

멀티플렉싱(Multiplexing)은 여러 장치가 동일한 물리적 인터페이스를 공유하면서도 독립적으로 작동할 수 있도록 하는 기술입니다. 멀티플렉싱은 데이터 전송 효율성을 극대화하기 위해 설계되었으며, 네트워크 통신, 신호 처리, 스토리지 시스템 등 다양한 분야에서 사용됩니다. PCIe 환경에서 멀티플렉싱은 여러 장치가 동일한 PCIe 레인을 공유할 수 있도록 하는 데 사용됩니다. 이를 위해 PCIe 스위치가 중요한 역할을 합니다. 스위치는 멀티플렉싱 기술을 활용하여 각 장치가 독립적으로 데이터를 송수신할 수 있도록 트래픽을 관리합니다. 예를 들어, 하나의 PCIe 레인을 통해 여러 장치가 데이터를 전송해야 할 경우, 스위치는 각 장치의 데이터 패킷을 시간적으로 분리하여 전송합니다. 이를 시분할 멀티플렉싱(Time Division Multiplexing, TDM)이라고 합니다. TDM은 각 장치에 고정된 시간 간격을 할당하여 데이터를 전송하며, 이를 통해 데이터 충돌을 방지하고 효율적인 통신을 보장합니다.


### PCIe와 네트워크 인터페이스

네트워크 카드(Network Interface Card, NIC)는 컴퓨터가 네트워크에 연결되어 데이터를 송수신할 수 있도록 하는 장치입니다. PCIe는 이러한 네트워크 카드를 시스템에 연결하는 데 사용되며, 특히 고속 네트워크 환경에서 필수적인 역할을 합니다. 예를 들어, 10GbE(10 Gigabit Ethernet) 또는 100GbE(100 Gigabit Ethernet)와 같은 고속 네트워크는 대량의 데이터를 빠르게 처리하고 전송해야 하며, 이를 위해 PCIe의 높은 대역폭과 낮은 레이턴시가 필요합니다. 네트워크 카드가 PCIe를 통해 연결되면, 데이터가 CPU와 메모리, 그리고 네트워크 간에 효율적으로 전송됩니다. PCIe의 높은 데이터 전송 속도는 네트워크 카드가 최대 성능을 발휘할 수 있도록 지원하며, 데이터센터와 클라우드 환경에서 대규모 데이터 처리를 가능하게 합니다.

데이터센터와 클라우드 환경에서는 고속 네트워크와 PCIe의 통합이 필수적입니다. 데이터센터는 수천 대의 서버와 스토리지 장치가 상호 연결되어 대량의 데이터를 처리하고 저장하는 환경입니다. 이러한 환경에서는 네트워크를 통해 데이터가 빠르게 이동해야 하며, 이를 위해 고속 네트워크 기술이 필요합니다. PCIe는 네트워크 카드와 서버 간의 데이터 전송 경로를 제공하며, 이를 통해 네트워크 트래픽이 병목현상 없이 처리될 수 있도록 합니다. 특히, 100GbE와 같은 고속 네트워크는 데이터센터와 클라우드 환경에서 대규모 데이터 전송을 지원하며, PCIe의 높은 대역폭은 이러한 고속 네트워크의 성능을 최대화하는 데 필수적입니다.

RDMA(Remote Direct Memory Access)는 PCIe와 네트워크 카드 간의 통합에서 중요한 기술 중 하나입니다. RDMA는 네트워크 장치가 CPU의 개입 없이 시스템 메모리와 직접 통신할 수 있도록 하는 기술입니다. 일반적으로 네트워크를 통해 데이터를 전송하려면 CPU가 데이터를 처리하고 이를 메모리에서 읽거나 쓰는 작업을 수행해야 합니다. 그러나 RDMA를 사용하면 네트워크 장치가 직접 메모리에 접근하여 데이터를 읽거나 쓸 수 있으므로, CPU의 부하를 줄이고 데이터 전송 속도를 향상시킬 수 있습니다. RDMA는 PCIe를 통해 네트워크 카드와 메모리가 연결된 상태에서 작동하며, 데이터센터와 클라우드 환경에서 높은 성능과 낮은 레이턴시를 요구하는 애플리케이션에서 널리 사용됩니다.


